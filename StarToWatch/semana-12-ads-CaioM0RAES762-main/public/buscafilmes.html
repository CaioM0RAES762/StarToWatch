<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscar Filme</title>
    <link rel="stylesheet" href="assents/css/pesquisa.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>

<body>


   <header class="d-flex justify-content-between align-items-center">
        <!-- MENU PRINCIPAL -->
        <nav class="caixa-menuprincipal">
            <ul>
                <li><a href="catalago.html">Catálogo</a></li>
                <li><a href="populares.html">Populares</a></li>
                <li><a href="cartaz.html">Em Cartaz</a></li>
                <li><a href="categorias.html">Categorias</a></li>
                <li><a href="buscafilmes.html"><i class="fas fa-search"></i> Buscar Filmes</a></li>
            </ul>
        </nav>

        <div class="perfil-infos">
            <div class="login" id="loginContainer">
                <a href="login.html" class="loginUser">Fazer login</a>
            </div>
            <button class="avatar-btn" onclick="toggleMenu()">
                <img src="avatarpadrao.png" alt="Avatar" class="avatar" id="avatar-btn">
            </button>
        </div>

        <div class="menu-user" id="menuPerfil">
            <ul>
                <li><img src="avatarpadrao.png" alt="" id="avatar-menu" class="avatar"> <span id="userName"> Seu
                        Nome</span></li>
                <li><span id="email">Seu email</span></li>
                <div class="linha"></div>
                <li><a href="ContaUser.html"><i class="bi bi-person-gear"></i> Minha conta</a></li>
                <li><a href="perfilUser.html"><i class="bi bi-box-arrow-up-right"></i> Mudar perfil</a></li>
                <li><a href="favoritos.html"><i class="bi bi-heart"></i> Favoritos</a></li>
                <li><a href="#"><i class="bi bi-person"></i> Sobre Nós</a></li>
                <li><a href="#"><i class="bi bi-question-circle"></i> Ajuda</a></li>
                <div class="linha"></div>
                <li><a href="paginainicial.html" class="exit" id="logout">Sair da conta</a></li>
            </ul>
        </div>

    </header>


    <nav class="tablet-nav">
        <a href="index.html"><i class="fas fa-home"></i>Home</a>
        <a href="buscafilmes.html"><i class="fas fa-search"></i>Buscar</a>
        <a href="populares.html"><i class="fas fa-fire"></i>Populares</a>
        <a href="#" id="btnTabletMais">
            <img src="avatarpadrao.png" alt="Avatar" class="avatar" id="avatar-btn-tablet"> Mais
        </a>
    </nav>


    <script>
        window.addEventListener('scroll', function () {
            const header = document.querySelector('header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
    </script>



    <main>
        <div class="caixa-pesquisa">
            <input id="searchInput" type="text" placeholder="Digite o nome do filme...">
            <i id="searchIcon" class="fas fa-search"></i>
        </div>
        <h1 class="titulo">Filmes Encontrados</h1>
        <p>Para facilitar a busca digite o título original em inglês</p>
        <div id="posterContainer"></div>
        <div id="sugestoes" class="sugestoes-box"></div>

        <script src="assents/js/pesquisa.js"></script>

    </main>


    <script>
        function toggleMenu() {
            const menu = document.getElementById('menuPerfil');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        window.addEventListener('click', function (e) {
            const menu = document.getElementById('menuPerfil');
            const avatarBtn = document.querySelector('.avatar-btn');
            const tabletBtn = document.getElementById('btnTabletMais');

            if (!menu.contains(e.target) &&
                (!avatarBtn || !avatarBtn.contains(e.target)) &&
                (!tabletBtn || !tabletBtn.contains(e.target))) {
                menu.style.display = 'none';
            }
        });

        window.onload = () => {
            const perfil = JSON.parse(localStorage.getItem('perfilSelecionado'));
            const usuario = JSON.parse(sessionStorage.getItem('usuario'));

            const avatarBtn = document.getElementById('avatar-btn');
            const avatarTablet = document.getElementById('avatar-btn-tablet');
            const avatarMenu = document.getElementById('avatar-menu');
            const userName = document.getElementById('userName');
            const emailSpan = document.getElementById('email');
            const loginContainer = document.getElementById('loginContainer');

            if (usuario) {
                if (loginContainer) loginContainer.style.display = 'none';

                if (perfil) {
                    if (avatarBtn) avatarBtn.src = perfil.imagem;
                    if (avatarTablet) avatarTablet.src = perfil.imagem;
                    if (avatarMenu) avatarMenu.src = perfil.imagem;

                    if (userName) {
                        const nome = perfil.nome;
                        const maxCharsNome = 12;
                        userName.textContent = nome.length > maxCharsNome ? nome.slice(0, maxCharsNome) + '...' : nome;
                    }
                }

                if (emailSpan) {
                    const email = usuario.login;
                    const maxChars = 15;
                    emailSpan.textContent = email.length > maxChars ? email.slice(0, maxChars) + '...' : email;
                }
            } else {
                if (loginContainer) loginContainer.style.display = 'block';
                if (avatarBtn) avatarBtn.src = 'avatarpadrao.png';
                if (avatarTablet) avatarTablet.src = 'avatarpadrao.png';
                if (avatarMenu) avatarMenu.src = 'avatarpadrao.png';
                if (userName) userName.textContent = 'Seu nome';
                if (emailSpan) emailSpan.textContent = 'Seu email';
            }
        };

        document.getElementById('btnTabletMais').addEventListener('click', function (e) {
            e.preventDefault();
            toggleMenu();
        });

        document.getElementById('logout')?.addEventListener('click', function () {
            sessionStorage.removeItem('usuario');
            window.location.href = 'login.html';
        });
    </script>


</body>

</html>